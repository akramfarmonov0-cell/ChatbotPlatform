🔧 AI AGENT 3 UCHUN YAKUNIY, TO‘LIQ, REAL BUSINESS SaaS PLATFORMA PROMPTI (v4.0 — HAMMASI KIRGAN!)
Siz — professional AI SaaS platformasi dasturchisiz. Foydalanuvchi sizga quyidagicha haqiqiy biznes loyihasini tuzishni buyurdi:

“Men O‘zbekistonda AI chatbot platformasini yaratmoqchiman. Foydalanuvchilar ro‘yxatdan o‘tadi — ism, telefon (+998 formatida), email, parol kiritadi. 3 kun bepul sinov beriladi. Ular PDF, DOCX, CSV, TXT fayllarni yuklab, biror bir bilim bazasini yaratadilar. Shu bilim bazasini Telegram, WhatsApp va Instagram’da bir vaqtning o‘zida ishlatadigan AI botga aylantiradilar. Barcha suhbatlar saqlanadi. Agar 3 kunlik sinov tugasa — foydalanuvchi ‘Dostupni so‘rash’ tugmasini bosadi. Men admin sifatida uni ‘monthly’, ‘quarterly’ yoki ‘annual’ rejaga qo‘yaman. Agar u pul to‘lamasa, har 54 soatda unga email orqali marketing xabar yuboriladi. Admin panelida barcha foydalanuvchilar, ularning mijozlari, suhbatlar, fayllar, integratsiyalar ko‘rinadi. Men admin sifatida barcha foydalanuvchilarga global habar yubora olaman. AI — Gemini 1.5 Flash bilan ishlaydi, lekin foydalanuvchi OpenAI tokenini kiritganda — u OpenAI ni ishlatadi. Til — Telegramda foydalanuvchi tanlaydi, WhatsApp/Instagramda esa mijozning tilini avtomatik aniqlayman (UZ/RU/EN). Loyiha Replitda test qilinishi mumkin, lekin asosan Render.com da deploy qilinadi.”

Endi siz — ushbu loyihani 100% amalga oshirasiz. Barcha fayllar, modellar, routelar, templatalar, utils, scheduler, shifrlash, email, webhook lar — hammasi tuzilishi kerak. Loyiha — hech qanday qo‘shimcha so‘rovga ehtiyoj sezmaydigan, “Run” tugmasini bosganda ishlaydigan, Render.ga deploy qilinishi uchun tayyor bo‘lishi kerak. 

✅ LOYIHA TALABLARI — HECH QANDAY QO‘SHIMCHA SO‘ROV KERAK EMAS
1. FOYDALANUVCHI RO‘YXATDAN O‘TISH (REGISTER)
Forma: full_name, phone (+998XX XXX XX XX formatida, regex validatsiya), email, password
Telefon raqami — O‘zbekiston formatida bo‘lishi shart. Boshqa mamlakatlar uchun keyinchalik kengaytiriladi.
Ro‘yxatdan o‘tgandan keyin — avtomatik 3 kunlik sinov boshlanadi (trial_ends_at = now() + 3 days)
Foydalanuvchi admin tasdiqlashi kerak emas — faqat sinov muddati tugaganda “Dostupni so‘rash” tugmasi paydo bo‘ladi.
2. BILIMLAR BAZASINI YUKLASH (PDF, DOCX, CSV, TXT)
Fayl turi: .pdf, .docx, .csv, .txt (faqat matnli)
Fayl tekstga aylantiriladi → knowledge_base jadvalida saqlanadi
Har bir foydalanuvchi faqat birta aktiv bilim bazasiga ega — yangi yuklash eski o‘chiriladi
Fayl max hajmi: 10 MB
✅ Kutubxonalar: 

PyPDF2 (PDF)
python-docx (DOCX)
pandas (CSV)
re (TXT)
3. TELEGRAM, WHATSAPP, INSTAGRAM INTEGRATSIYASI (BIR BILIM BAZASI — UCHTA CHIQISH)
Telegram
Bot tokeni kiritiladi →
/telegram/webhook/<user_id>
Foydalanuvchi
tilni tanlaydi
(UZ/RU/EN) — bot shu tilga javob beradi
WhatsApp
Meta API: app_id, app_secret, phone_number_id →
/whatsapp/webhook
Mijoz qaysi tilda yozsa —
shu tilga avtomatik javob beradi
Instagram
Facebook Graph API: access_token, page_id →
/instagram/webhook
Mijoz qaysi tilda yozsa —
shu tilga avtomatik javob beradi

✅ Til aniqlash: langdetect kutubxonasi — foydalanuvchi xabarini tekshiradi → uz, ru, en aniqlanadi.
✅ Tokenlar shifrlangan holda — cryptography.fernet bilan saqlanadi.
✅ Webhooklar faqat POST — GET faqat verification uchun (WhatsApp/Instagram). 

4. AVTOMATIK MARKETING (TRIAL FAYDALANUVCHILARGA)
Agar foydalanuvchi 3 kun ichida pullik rejani olmasa:
Har 54 soatda (2 kunda) — email orqali xabar yuboriladi:
“Salom! Sizning sinov muddatingiz tugagan. 1 oylik rejani faollashtirish uchun [tugma] bosib, bizga murojaat qiling. Biz sizga 10% chegirma beramiz!” 
Xabar — SMTP (Gmail App Password) orqali yuboriladi.
Foydalanuvchi “Dostupni so‘rash” tugmasini bosganda — admin panelda “Pending Plans” bo‘limida ko‘rinadi.
Admin — uni “monthly”, “quarterly”, “annual” rejaga qo‘yadi → plan_expires_at = now() + 30/90/365 days
5. ADMIN PANELI — PUXTA, PROFESSIONAL, BARCHANI BOSHQARISH UCHUN
✅ Barcha foydalanuvchilar ro‘yxati — status: free / paid / banned
✅ Foydalanuvchi tafsilotlari — telefon, email, bilim bazasi, integratsiyalar, so‘rovlar
✅ Mijozlar suhbatlari — har bir foydalanuvchining Telegram/WhatsApp/Instagram suhbatlari tarixi (filter by platform, user, date)
✅ Global habar yuborish — admin barcha foydalanuvchilarga bir xabar yubora oladi
✅ Foydalanuvchilarning mijozlariga habar yuborish — admin o‘zi mijozga xabar yubora oladi (masalan: “Sizning botingizga yangi savollar qo‘shildi”)
✅ To‘lovlar boshqaruvi — foydalanuvchiga “monthly” rejani qo‘yish, muddatini uzaytirish
✅ Statistika — nechta foydalanuvchi, nechta bilim bazasi, nechta suhbat, qaysi platforma eng ko‘p
✅ Foydalanuvchini bloklash/yopish — “Ban User” tugmasi
✅ “Pending Plan Requests” — foydalanuvchilar so‘rovlari ro‘yxati 

6. DUAL AI SUPPORT — GEMINI + OPENAI
Hozirgi AI: Google Gemini 1.5 Flash (foydalanuvchi uchun standart)
Keyingi AI: OpenAI GPT-3.5 Turbo (foydalanuvchi o‘zi tokenini kiritsa)
Admin panelida:
“AI modelni tanlang: Geminni ishlatish (sizning kalitingiz bilan) / OpenAI ishlatish (foydalanuvchi tokenini kiritsa)” 
Foydalanuvchi o‘zining OpenAI API key ini kiritsa — u Gemini o‘rniga OpenAI dan foydalanadi
Tokenlar — cryptography.fernet bilan shifrlangan holda saqlanadi
7. MULTI-LANGUAGE SUPPORT — UZ, RU, EN
Barcha matnlar _() ichida — Flask-Babel bilan
Til o‘zgarishlari:
Telegramda — foydalanuvchi tanlagan til (admin panelida sozlanadi)
WhatsApp/Instagramda — mijozning xabaridan avtomatik aniqlanadi (langdetect)
Admin panelida — tilni o‘zgartirish imkoniyati
8. DEPLOYMENT — RENDER.COM UCHUN TAYYOR
Procfile: web: gunicorn --bind 0.0.0.0:$PORT main:app
.env fayli:


1
2
3
4
5
6
7
SECRET_KEY=your_super_secret_key_here
GEMINI_API_KEY=your_gemini_key
OPENAI_API_KEY=optional_openai_key
MAIL_USERNAME=your@gmail.com
MAIL_PASSWORD=your_app_password
WEBHOOK_BASE_URL=https://your-app.onrender.com
DATABASE_URL=sqlite:///app.db
Replitda test qilinishi mumkin — lekin webhooklar faqat Render.da ishlaydi
9. FAKULTATIV: “10% CHEGIRMA” KOUPON GENERATORI
Admin panelida — “Generate Coupon” tugmasi
Tugma bosilganda — random coupon code generatsiya qilinadi (masalan: SAVE10_UZ_2025)
Foydalanuvchi “Dostupni so‘rash” formada kodni kiritsa — 10% chegirma beriladi
🗂️ LOYIHA STRUKTURASI (TO‘LIQ YANGI)


1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
main.py
requirements.txt
.env
config.py
models/
  ├── user.py
  ├── knowledge_base.py
  ├── messaging.py          ← TelegramBot, WhatsAppAccount, InstagramAccount
  ├── conversation.py       ← Barcha suhbatlar
  ├── ai_config.py          ← Gemini/OpenAI tanlovi
  ├── marketing.py          ← MarketingMessage, Coupon
  └── admin_log.py          ← Admin harakatlari logi
routes/
  ├── main_routes.py
  ├── auth_routes.py        ← login/register/logout
  ├── kb_routes.py          ← bilim bazasini yuklash
  ├── messaging_routes.py   ← /telegram/webhook, /whatsapp/webhook, etc.
  └── admin_routes.py       ← barcha admin funksiyalari
utils/
  ├── ai_handler.py         ← gemini + openai dual logic
  ├── file_parser.py        ← pdf/docx/csv/txt parser
  ├── messaging/
  │   ├── telegram.py
  │   ├── whatsapp.py
  │   └── instagram.py
  ├── email_sender.py       ← SMTP yuborish
  ├── crypto_utils.py       ← Fernet shifrlash
  └── lang_detector.py      ← langdetect
templates/
  ├── base.html
  ├── index.html
  ├── register.html
  ├── login.html
  ├── dashboard.html
  ├── upload_kb.html
  ├── bots.html             ← Telegram/WhatsApp/Instagram ulash
  ├── pending_request.html
  ├── admin/
  │   ├── dashboard.html
  │   ├── users.html
  │   ├── conversations.html
  │   ├── announcements.html
  │   ├── stats.html
  │   └── coupons.html
static/
  ├── css/
  │   └── style.css
  ├── js/
  │   ├── main.js
  │   ├── bot-integrations.js
  │   └── admin-dashboard.js
  └── uploads/
      └── knowledge/
          └── user_123/
              └── manual.pdf
✅ YAKUNIY SHART:
AI Agent 3 — ushbu barcha modullarni, fayllarni, logikani, shifrlashni, mailni, scheduler ni, webhook larni, dual AI ni, 3 tilni, 3 platformani, telefon validatsiyasini, admin panelini — bitta, to‘g‘ri, ishlaydigan, Replitda test qilinishi mumkin bo‘lgan, Render.ga deploy qilinishi uchun tayyor, professional SaaS platformasini tuzishi kerak.

Hech qanday xato, hech qanday import error, hech qanday “undefined variable”, hech qanday “webhook not working” bo‘lmasligi kerak.

Agar bitta fayl noto‘g‘ri bo‘lsa — loyihani ishga tushirmasdan oldin qayta tuzing.

Loyiha — hozir O‘zbekiston uchun, lekin rus va ingliz tiliga oson moslanadigan struktura bo‘lishi kerak. 

